###
### sensor.motion.yaml
###

##
## GROUP START - 'motion/+/start'
##

- platform: mqtt
  name: motion_device_start
  qos: 2
  state_topic: 'motion/+/start'
  json_attributes:
    - unit_system
    - latitude
    - longitude
    - elevation
    - interval
    - minimum_animate
    - post_pictures
    - share_dir
    - name
    - host
    - date
    - www
    - devicedb
    - timezone
    - mqtt
    - watson
    - digits
    - motion
    - cameras
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}
- platform: template
  sensors:
    motion_device_start_camera_count:
      entity_id:
        - sensor.motion_device_start
      value_template: >-
        {% if states.sensor.motion_device_start.attributes.cameras is defined %}
          {{ states.sensor.motion_device_start.attributes.cameras | length }}
        {% else %}null{% endif %}
    motion_device_start_camera_names:
      entity_id:
        - sensor.motion_device_start
      value_template: >-
        {% if states.sensor.motion_device_start.attributes.cameras is defined %}
          {%- for camera in states.sensor.motion_device_start.attributes.cameras -%}
            {% if loop.first %}[{% else %},{% endif %}
            {{- camera.name | tojson -}}
            {%- if loop.last -%}]{%- endif -%}
          {% endfor %}
        {% else %}null{% endif %}

##
## CAMERA FOUND - 'motion/+/+/status/found'
##

- platform: mqtt
  name: motion_camera_found
  state_topic: 'motion/+/+/status/found'
  qos: 2
  expire_after: 1
  force_update: True
  json_attributes:
    - device
    - camera
    - date
    - status
  value_template: >
    {% if value_json is defined %}True{% else %}null{% endif %}

##
## CAMERA LOST - 'motion/+/+/status/lost' 
##

- platform: mqtt
  name: motion_camera_lost
  state_topic: 'motion/+/+/status/lost'
  qos: 2
  expire_after: 1
  force_update: True
  json_attributes:
    - device
    - camera
    - date
    - status
  value_template: >
    {% if value_json is defined %}True{% else %}null{% endif %}

##
## EVENT IMAGE - motion/+/+/event/image
##

- platform: mqtt
  name: motion_event_image
  qos: 2
  state_topic: 'motion/+/+/event/image'
  expire_after: 1
  force_update: True
  json_attributes:
    - device
    - camera
    - type
    - date
    - seqno
    - event
    - id
    - center
    - width
    - height
    - size
    - noise
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}

## standard event count, ago, mean, status
- platform: template
  sensors:
    ## human readable
    motion_image_status:
      entity_id:
        - sensor.motion_event_image
      value_template: >-
        {% if states.sensor.motion_event_image is defined and states.sensor.motion_event_image.attributes.camera is defined %}
          From {{ states.sensor.motion_event_image.attributes.device }} {{ states.sensor.motion_event_image.attributes.camera }}
        {% else %} null {% endif %}
    ## timing
    motion_image_date:
      entity_id:
        - sensor.motion_event_image
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_image.attributes.date is defined %}
          {% if states.sensor.motion_event_image.attributes.date|int is number %}
            {% if states.sensor.motion_event_image.attributes.date|int > 0 %}
              {{ states.sensor.motion_event_image.attributes.date|int }}
            {%- else -%}null{%- endif -%}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    # human readable
    motion_image_when:
      entity_id:
        - sensor.motion_image_date
      value_template: >
        {% if states.sensor.motion_image_date is defined %}
          {{ states.sensor.motion_image_date.state|int|timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %} null {% endif %}
    # seconds ago
    motion_image_ago:
      entity_id:
        - sensor.motion_image_date
        - sun.sun
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_date is defined %}
          {% if states.sensor.motion_image_date.state|int is number %}
              {{ (now().timestamp()|int) - (states.sensor.motion_image_date.state|int) }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_image_ago_mean:
      entity_id:
        - sensor.motion_image_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_ago_statistics is defined %}
          {{ states.sensor.motion_image_ago_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_image_ago_min_value:
      entity_id:
        - sensor.motion_event_image
        - sensor.motion_event_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_ago_statistics is defined %}
          {{ states.sensor.motion_image_ago_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_image_ago_max_value:
      entity_id:
        - sensor.motion_event_image
        - sensor.motion_event_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_ago_statistics is defined %}
          {{ states.sensor.motion_image_ago_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_image_ago_stdev:
      entity_id:
        - sensor.motion_image_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_ago_statistics is defined %}
          {{ states.sensor.motion_image_ago_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_image_ago_change_rate:
      entity_id:
        - sensor.motion_image_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_ago_statistics is defined %}
          {{ states.sensor.motion_image_ago_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## counting
    motion_image_counter:
      entity_id:
        - counter.motion_image_counter
      unit_of_measurement: count
      value_template: >
        {% if states.counter.motion_image_counter is defined %}
          {{ states.counter.motion_image_counter.state|int }}
        {%- else -%}null{%- endif -%}
    motion_image_counter_mean:
      entity_id:
        - sensor.motion_image_counter_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_counter_statistics is defined %}
          {{ states.sensor.motion_image_counter_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_image_counter_min_value:
      entity_id:
        - sensor.motion_event_image
        - sensor.motion_event_counter_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_counter_statistics is defined %}
          {{ states.sensor.motion_image_counter_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_image_counter_max_value:
      entity_id:
        - sensor.motion_event_image
        - sensor.motion_event_counter_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_counter_statistics is defined %}
          {{ states.sensor.motion_image_counter_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_image_counter_stdev:
      entity_id:
        - sensor.motion_image_counter_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_counter_statistics is defined %}
          {{ states.sensor.motion_image_counter_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_image_counter_change_rate:
      entity_id:
        - sensor.motion_image_counter_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_image_counter_statistics is defined %}
          {{ states.sensor.motion_image_counter_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## attributes
    motion_image_device:
      entity_id:
        - sensor.motion_event_image
      value_template: >
        {% if states.sensor.motion_event_image is defined and states.sensor.motion_event_image.attributes.device is defined %}
          {{ states.sensor.motion_event_image.attributes.device }}
        {% else %} null {% endif %}
    motion_image_camera:
      entity_id:
        - sensor.motion_event_image
      value_template: >
        {% if states.sensor.motion_event_image is defined and states.sensor.motion_event_image.attributes.camera is defined %}
          {{ states.sensor.motion_event_image.attributes.camera }}
        {% else %} null {% endif %}
    motion_image_type:
      entity_id:
        - sensor.motion_event_image
      value_template: >
        {% if states.sensor.motion_event_image is defined and states.sensor.motion_event_image.attributes.type is defined %}
          {{ states.sensor.motion_event_image.attributes.type }}
        {% else %} null {% endif %}
    motion_image_center:
      entity_id:
        - sensor.motion_event_image
      value_template: >
        {% if states.sensor.motion_event_image is defined and states.sensor.motion_event_image.attributes.center is defined %}
          {{ states.sensor.motion_event_image.attributes.center }}
        {% else %} null {% endif %}

##
## START EVENT
##

- platform: mqtt
  name: motion_event_start
  qos: 2
  state_topic: 'motion/+/+/event/start'
  expire_after: 1
  force_update: True
  json_attributes:
    - device
    - camera
    - event
    - start
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}
- platform: template
  sensors:
    ## timing
    motion_event_start_ago:
      entity_id:
        - sensor.motion_event_start
        - sun.sun
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_start.attributes.date is defined %}
          {{ (now().timestamp()|int) - (states.sensor.motion_event_start.attributes.start|int) }}
        {%- else -%}null{%- endif -%}
    motion_start_device:
      entity_id:
        - sensor.motion_event_start
      value_template: >
        {% if states.sensor.motion_event_start is defined %}
          {{ states.sensor.motion_event_start.attributes.device }}
        {% else %} null {% endif %}
    motion_start_camera:
      entity_id:
        - sensor.motion_event_start
      value_template: >
        {% if states.sensor.motion_event_start is defined %}
          {{ states.sensor.motion_event_start.attributes.camera }}
        {% else %} null {% endif %}
    motion_start_when:
      entity_id:
        - sensor.motion_event_start
      value_template: >
        {% if states.sensor.motion_event_start is defined %}
          {{ states.sensor.motion_event_start.attributes.start | int | timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %} null {% endif %}

##
## END EVENT
##

- platform: mqtt
  name: motion_event_end
  qos: 2
  state_topic: 'motion/+/+/event/end'
  expire_after: 1
  force_update: True
  json_attributes:
    - device
    - camera
    - event
    - start
    - end
    - elapsed
    - date
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}
## standard event count, ago, mean, status
- platform: template
  sensors:
    ## status
    motion_status:
      entity_id:
        - sensor.motion_event_end
      value_template: >-
        {% if states.sensor.motion_event_end is defined and states.sensor.motion_event_end.attributes.camera is defined %}
          From {{ states.sensor.motion_event_end.attributes.device }} {{ states.sensor.motion_event_end.attributes.camera }}
        {% else %} null {% endif %}
    ## timing
    motion_date:
      entity_id:
        - sensor.motion_event_end
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_end.attributes.end is defined %}
          {% if states.sensor.motion_event_end.attributes.end|int is number %}
            {% if states.sensor.motion_event_end.attributes.end|int > 0 %}
              {{ states.sensor.motion_event_end.attributes.end|int }}
            {%- else -%}null{%- endif -%}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    # human readable
    motion_when:
      entity_id:
        - sensor.motion_date
      value_template: >
        {% if states.sensor.motion_date is defined %}
          {{ states.sensor.motion_date.state|int|timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %} null {% endif %}
    # seconds ago
    motion_ago:
      entity_id:
        - sensor.motion_date
        - sun.sun
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_date is defined %}
          {% if states.sensor.motion_date.state|int is number %}
            {% if states.sensor.motion_date.state|int > 0 %}
              {{ (now().timestamp()|int) - (states.sensor.motion_date.state|int) }}
            {%- else -%}null{%- endif -%}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    ## ago statistics
    motion_ago_mean:
      entity_id:
        - sensor.motion_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_ago_statistics is defined %}
          {{ states.sensor.motion_ago_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_ago_min_value:
      entity_id:
        - sensor.motion_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_ago_statistics is defined %}
          {{ states.sensor.motion_ago_statistics.attributes.min_value|float }}
        {%- else -%}null{%- endif -%}
    motion_ago_max_value:
      entity_id:
        - sensor.motion_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_ago_statistics is defined %}
          {{ states.sensor.motion_ago_statistics.attributes.max_value|float }}
        {%- else -%}null{%- endif -%}
    motion_ago_stdev:
      entity_id:
        - sensor.motion_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_ago_statistics is defined %}
          {{ states.sensor.motion_ago_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_ago_change_rate:
      entity_id:
        - sensor.motion_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_ago_statistics is defined %}
          {{ states.sensor.motion_ago_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # seconds elapsed
    motion_elapsed:
      entity_id:
        - sensor.motion_event_end
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_end is defined %}
          {{ states.sensor.motion_event_end.attributes.elapsed|int }}
        {% else %}null{% endif %}
    motion_elapsed_mean:
      entity_id:
        - sensor.motion_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_elapsed_statistics is defined %}
          {{ states.sensor.motion_elapsed_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_elapsed_min_value:
      entity_id:
        - sensor.motion_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_elapsed_statistics is defined %}
          {{ states.sensor.motion_elapsed_statistics.attributes.min_value|float }}
        {%- else -%}null{%- endif -%}
    motion_elapsed_max_value:
      entity_id:
        - sensor.motion_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_elapsed_statistics is defined %}
          {{ states.sensor.motion_elapsed_statistics.attributes.max_value|float }}
        {%- else -%}null{%- endif -%}
    motion_elapsed_stdev:
      entity_id:
        - sensor.motion_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_elapsed_statistics is defined %}
          {{ states.sensor.motion_elapsed_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_elapsed_change_rate:
      entity_id:
        - sensor.motion_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_elapsed_statistics is defined %}
          {{ states.sensor.motion_elapsed_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## counting
    motion_counter:
      entity_id:
        - counter.motion_counter
      unit_of_measurement: count
      value_template: >
        {% if states.counter.motion_counter is defined %}
          {{ states.counter.motion_counter.state|int }}
        {%- else -%}null{%- endif -%}
    # count derived
    motion_counter_mean:
      entity_id:
        - sensor.motion_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_counter_statistics is defined %}
          {{ states.sensor.motion_counter_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_counter_min_value:
      entity_id:
        - sensor.motion_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_counter_statistics is defined %}
          {{ states.sensor.motion_counter_statistics.attributes.min_value|float }}
        {%- else -%}null{%- endif -%}
    motion_counter_max_value:
      entity_id:
        - sensor.motion_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_counter_statistics is defined %}
          {{ states.sensor.motion_counter_statistics.attributes.max_value|float }}
        {%- else -%}null{%- endif -%}
    motion_counter_stdev:
      entity_id:
        - sensor.motion_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_counter_statistics is defined %}
          {{ states.sensor.motion_counter_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_counter_change_rate:
      entity_id:
        - sensor.motion_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_counter_statistics is defined %}
          {{ states.sensor.motion_counter_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## attributes
    motion_event:
      entity_id:
        - sensor.motion_event_end
      value_template: >
        {% if states.sensor.motion_event_end is defined %}
          {{ states.sensor.motion_event_end.attributes.event }}
        {% else %} null {% endif %}
    motion_device:
      entity_id:
        - sensor.motion_event_end
      value_template: >
        {% if states.sensor.motion_event_end is defined %}
          {{ states.sensor.motion_event_end.attributes.device }}
        {% else %} null {% endif %}
    motion_camera:
      entity_id:
        - sensor.motion_event_end
      value_template: >
        {% if states.sensor.motion_event_end is defined %}
          {{ states.sensor.motion_event_end.attributes.camera }}
        {% else %} null {% endif %}
    motion_image_count:
      entity_id:
        - sensor.motion_event_end
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_event_end is defined %}
          {{ states.sensor.motion_event_end.attributes.images | length }}
        {% else %} null {% endif %}
    motion_image_first:
      entity_id:
        - sensor.motion_event_end
      value_template: >-
        {% if states.sensor.motion_event_end is defined %}
          {% for image in states.sensor.motion_event_end.attributes.images %}
            {% if loop.first %} {{ image }} {% endif %}
          {% endfor %}
        {% else %} null {% endif %}
    motion_image_last:
      entity_id:
        - sensor.motion_event_end
      ##{{ (states.sensor.motion_event_end_event.attributes.images|last).state }}
      value_template: >-
        {% if states.sensor.motion_event_end is defined %}
          {% for image in states.sensor.motion_event_end.attributes.images %}
            {% if loop.last %} {{ image }} {% endif %}
          {% endfor %}
        {% else %} null {% endif %}

###
### ENTITY SELECTION
###

- platform: template
  sensors:
    ## entity selected from input_select.motion_detect_entity (e.g. 'person')
    motion_detect_entity:
      entity_id:
        - input_select.motion_detect_entity
      value_template: >-
        {% if states.input_select.motion_detect_entity is defined %}
          {{ states.input_select.motion_detect_entity.state }}
        {% else %}null{% endif %}

##
## ANNOTATED EVENT
##

- platform: mqtt
  name: motion_event_annotated
  state_topic: 'motion/p40/+/event/end/+'
  qos: 2
  expire_after: 1
  force_update: True
  json_attributes:
    - timestamp
    - date
    - time
    - count
    - event
    - info
    - detected
  value_template: >
    {% if value_json is defined %}True{% else %}False{% endif %}
## sensors for annotated (event)
- platform: template
  sensors:
    ## human readable status
    motion_annotated_status:
      entity_id:
        - sensor.motion_event_annotated
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined and states.sensor.motion_event_annotated.attributes.count|int > 0 %}
          Annotated {{ states.sensor.motion_event_annotated.attributes.count }}  entities
          from {{ states.sensor.motion_event_annotated.attributes.event.device -}}/{{- states.sensor.motion_event_annotated.attributes.event.camera }} 
        {% else %}
          Nothing annotated
        {% endif %}
    ## timing
    motion_annotated_date:
      entity_id:
        - sensor.motion_event_annotated
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.sensor.motion_event_annotated.attributes.event.end|int is number %}
            {% if states.sensor.motion_event_annotated.attributes.event.end|int > 0 %}
              {{ states.sensor.motion_event_annotated.attributes.event.end|int }}
            {% else %} null {% endif %}
          {% else %} null {% endif %}
        {% else %} null {% endif %}
    # human readable
    motion_annotated_when:
      entity_id:
        - sensor.motion_annotated_date
      value_template: >-
        {% if states.sensor.motion_annotated_date is defined %}
          {{ states.sensor.motion_annotated_date.state|int|timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %}null{% endif %}
    # ago
    motion_annotated_ago:
      entity_id:
        - sensor.motion_annotated_date
        - sun.sun
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_date is defined %}
          {% if states.sensor.motion_annotated_date.state|int is number %}
            {% if states.sensor.motion_annotated_date.state|int > 0 %}
              {{ (now().timestamp()|int) - (states.sensor.motion_annotated_date.state|int) }}
            {%- else -%}null{%- endif -%}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    # derived ago
    motion_annotated_ago_mean:
      entity_id:
        - sensor.motion_annotated_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_ago_statistics is defined %}
          {{ states.sensor.motion_annotated_ago_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_min_value:
      entity_id:
        - sensor.motion_annotated_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_ago_statistics is defined %}
          {{ states.sensor.motion_annotated_ago_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_max_value:
      entity_id:
        - sensor.motion_annotated_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_ago_statistics is defined %}
          {{ states.sensor.motion_annotated_ago_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_stdev:
      entity_id:
        - sensor.motion_annotated_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_ago_statistics is defined %}
          {{ states.sensor.motion_annotated_ago_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_ago_change_rate:
      entity_id:
        - sensor.motion_annotated_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_ago_statistics is defined %}
          {{ states.sensor.motion_annotated_ago_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # elapsed
    motion_annotated_elapsed:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_annotated
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_annotated.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.event.elapsed|int }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    motion_annotated_elapsed_mean:
      entity_id:
        - sensor.motion_annotated_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_elapsed_statistics is defined %}
          {{ states.sensor.motion_annotated_elapsed_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_elapsed_min_value:
      entity_id:
        - sensor.motion_annotated_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_elapsed_statistics is defined %}
          {{ states.sensor.motion_annotated_elapsed_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_elapsed_max_value:
      entity_id:
        - sensor.motion_annotated_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_elapsed_statistics is defined %}
          {{ states.sensor.motion_annotated_elapsed_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_elapsed_stdev:
      entity_id:
        - sensor.motion_annotated_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_elapsed_statistics is defined %}
          {{ states.sensor.motion_annotated_elapsed_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_elapsed_change_rate:
      entity_id:
        - sensor.motion_annotated_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_elapsed_statistics is defined %}
          {{ states.sensor.motion_annotated_elapsed_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # delay 
    motion_annotated_delay:
      entity_id:
        - sensor.motion_event_annotated
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_annotated.state == 'on' %}
            {{ (now().timestamp()|int) - ( states.sensor.motion_event_annotated.attributes.event.end|int) }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    motion_annotated_delay_mean:
      entity_id:
        - sensor.motion_annotated_delay_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_delay_statistics is defined %}
          {{ states.sensor.motion_annotated_delay_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_min_value:
      entity_id:
        - sensor.motion_annotated_delay_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_delay_statistics is defined %}
          {{ states.sensor.motion_annotated_delay_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_max_value:
      entity_id:
        - sensor.motion_annotated_delay_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_annotated_delay_statistics is defined %}
          {{ states.sensor.motion_annotated_delay_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_stdev:
      entity_id:
        - sensor.motion_annotated_delay_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_delay_statistics is defined %}
          {{ states.sensor.motion_annotated_delay_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_delay_change_rate:
      entity_id:
        - sensor.motion_annotated_delay_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_annotated_delay_statistics is defined %}
          {{ states.sensor.motion_annotated_delay_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## counting annotated (events)
    motion_annotated_counter:
      entity_id:
        - counter.motion_annotated_counter
      unit_of_measurement: count
      value_template: >
        {% if states.counter.motion_annotated_counter is defined %}
          {{ states.counter.motion_annotated_counter.state|int }}
        {%- else -%}null{%- endif -%}
    # derived detected counter statistics
    motion_annotated_counter_mean:
      entity_id:
        - sensor.motion_annotated_counter_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_annotated_counter_statistics is defined %}
          {{ states.sensor.motion_annotated_counter_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_counter_min_value:
      entity_id:
        - sensor.motion_annotated_counter_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_annotated_counter_statistics is defined %}
          {{ states.sensor.motion_annotated_counter_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_counter_max_value:
      entity_id:
        - sensor.motion_annotated_counter_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_annotated_counter_statistics is defined %}
          {{ states.sensor.motion_annotated_counter_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_counter_stdev:
      entity_id:
        - sensor.motion_annotated_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_annotated_counter_statistics is defined %}
          {{ states.sensor.motion_annotated_counter_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_counter_change_rate:
      entity_id:
        - sensor.motion_annotated_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_annotated_counter_statistics is defined %}
          {{ states.sensor.motion_annotated_counter_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # percent of motion events which were annotated
    motion_annotated_percent:
      entity_id:
        - counter.motion_counter
        - counter.motion_annotated_counter
      unit_of_measurement: '%'
      value_template: >-
        {% if states.counter.motion_counter is defined and states.motion_annotated_counter is defined %}
          {% if states.counter.motion_counter.state|int > 0 %}
            {{  ( states.counter.motion_annotated_counter.state|int / states.counter.motion_counter.state|int ) * 100.0 }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    # derived annotated percent statistics
    motion_annotated_percent_mean:
      entity_id:
        - sensor.motion_annotated_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_annotated_percent_statistics is defined %}
          {{ states.sensor.motion_annotated_percent_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_min_value:
      entity_id:
        - sensor.motion_annotated_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_annotated_percent_statistics is defined %}
          {{ states.sensor.motion_annotated_percent_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_max_value:
      entity_id:
        - sensor.motion_annotated_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_annotated_percent_statistics is defined %}
          {{ states.sensor.motion_annotated_percent_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_stdev:
      entity_id:
        - sensor.motion_annotated_percent_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states.sensor.motion_annotated_percent_statistics is defined %}
          {{ states.sensor.motion_annotated_percent_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_percent_change_rate:
      entity_id:
        - sensor.motion_annotated_percent_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states.sensor.motion_annotated_percent_statistics is defined %}
          {{ states.sensor.motion_annotated_percent_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## counting entities
    motion_annotated_count:
      entity_id:
        - sensor.motion_event_annotated
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {{ states.sensor.motion_event_annotated.attributes.count }}
        {% else %} null {% endif %}
    ## derived attributes from statistics
    motion_annotated_count_mean:
      entity_id:
        - sensor.motion_annotated_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_annotated_count_statistics is defined %}
          {{ states.sensor.motion_annotated_count_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_count_min_value:
      entity_id:
        - sensor.motion_event_annotated_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_annotated_count_statistics is defined %}
          {{ states.sensor.motion_annotated_count_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_count_max_value:
      entity_id:
        - sensor.motion_event_annotated_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_annotated_count_statistics is defined %}
          {{ states.sensor.motion_annotated_count_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_annotated_count_stdev:
      entity_id:
        - sensor.motion_annotated_count_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states.sensor.motion_annotated_count_statistics is defined %}
          {{ states.sensor.motion_annotated_count_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_annotated_count_change_rate:
      entity_id:
        - sensor.motion_annotated_count_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states.sensor.motion_annotated_count_statistics is defined %}
          {{ states.sensor.motion_annotated_count_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## attributes
    motion_annotated_detected:
      entity_id:
        - sensor.motion_event_annotated
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {{ states.sensor.motion_event_annotated.attributes.detected }}
        {% else %} null {% endif %}
    motion_annotated_device:
      entity_id:
        - sensor.motion_event_annotated
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {{ states.sensor.motion_event_annotated.attributes.event.device }}
        {% else %}null{% endif %}
    motion_annotated_camera:
      entity_id:
        - sensor.motion_event_annotated
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {{ states.sensor.motion_event_annotated.attributes.event.camera }}
        {% else %}null{% endif %}

###
### DETECTED (anything)
###

- platform: template
  sensors:
    ## human readable status
    motion_detected_status:
      entity_id:
        - sensor.motion_event_annotated
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined and states.sensor.motion_event_annotated.attributes.count|int > 0 %}
          Detected {{ states.sensor.motion_event_annotated.attributes.count }} entities
          from {{ states.sensor.motion_event_annotated.attributes.event.device -}}/{{- states.sensor.motion_event_annotated.attributes.event.camera }} 
        {% else %}
          Detected zero entities
          from {{ states.sensor.motion_event_annotated.attributes.event.device -}}/{{- states.sensor.motion_event_annotated.attributes.event.camera }} 
        {% endif %}

    ## timing
    motion_detected_date:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_detected
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected.state == 'on' %}
            {% if states.sensor.motion_event_annotated.attributes.event.end|int is number %}
              {% if states.sensor.motion_event_annotated.attributes.event.end|int > 0 %}
                {{ states.sensor.motion_event_annotated.attributes.event.end|int }}
              {% else %}null{% endif %}
            {% else %}null{% endif %}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    # human readable
    motion_detected_when:
      entity_id:
        - sensor.motion_detected_date
      value_template: >-
        {% if states.sensor.motion_detected_date is defined %}
          {{ states.sensor.motion_detected_date.state|int|timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %}null{% endif %}
    # ago
    motion_detected_ago:
      entity_id:
        - sensor.motion_detected_date
        - sun.sun
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_date is defined %}
          {% if states.sensor.motion_detected_date.state|int is number %}
            {% if states.sensor.motion_detected_date.state|int > 0 %}
              {{ (now().timestamp()|int) - (states.sensor.motion_detected_date.state|int) }}
            {%- else -%}null{%- endif -%}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    # derived ago
    motion_detected_ago_mean:
      entity_id:
        - sensor.motion_detected_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_ago_statistics is defined %}
          {% if states.sensor.motion_detected_ago_statistics.state|int is number %}
            {{ states.sensor.motion_detected_ago_statistics.state|float }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_min_value:
      entity_id:
        - sensor.motion_detected_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_ago_statistics is defined %}
          {{ states.sensor.motion_detected_ago_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_max_value:
      entity_id:
        - sensor.motion_detected_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_ago_statistics is defined %}
          {{ states.sensor.motion_detected_ago_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_stdev:
      entity_id:
        - sensor.motion_detected_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_ago_statistics is defined %}
          {{ states.sensor.motion_detected_ago_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_ago_change_rate:
      entity_id:
        - sensor.motion_detected_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_ago_statistics is defined %}
          {{ states.sensor.motion_detected_ago_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # elapsed
    motion_detected_elapsed:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_detected
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.event.elapsed|int }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    motion_detected_elapsed_mean:
      entity_id:
        - sensor.motion_detected_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_elapsed_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_elapsed_min_value:
      entity_id:
        - sensor.motion_detected_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_elapsed_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_elapsed_max_value:
      entity_id:
        - sensor.motion_detected_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_elapsed_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_elapsed_stdev:
      entity_id:
        - sensor.motion_detected_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_elapsed_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_elapsed_change_rate:
      entity_id:
        - sensor.motion_detected_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_elapsed_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## detected counter
    motion_detected_counter:
      entity_id:
        - counter.motion_detected_counter
      unit_of_measurement: count
      value_template: >
        {% if states.counter.motion_detected_counter is defined %}
          {{ states.counter.motion_detected_counter.state|int }}
        {%- else -%}null{%- endif -%}
    # derived attributes from statistics on counter
    motion_detected_counter_mean:
      entity_id:
        - sensor.motion_detected_counter_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_counter_statistics is defined %}
          {{ states.sensor.motion_detected_counter_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_counter_min_value:
      entity_id:
        - sensor.motion_detected_counter_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_counter_statistics is defined %}
          {{ states.sensor.motion_detected_counter_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_counter_max_value:
      entity_id:
        - sensor.motion_detected_counter_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_counter_statistics is defined %}
          {{ states.sensor.motion_detected_counter_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_counter_stdev:
      entity_id:
        - sensor.motion_detected_counter_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_counter_statistics is defined %}
          {{ states.sensor.motion_detected_counter_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_counter_change_rate:
      entity_id:
        - sensor.motion_detected_counter_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_counter_statistics is defined %}
          {{ states.sensor.motion_detected_counter_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # percent of motion events which were detected
    motion_detected_percent:
      entity_id:
        - counter.motion_counter
        - counter.motion_detected_counter
      unit_of_measurement: '%'
      value_template: >-
        {% if states.counter.motion_counter is defined and states.motion_detected_counter is defined %}
          {% if states.counter.motion_counter.state|int > 0 %}
            {{  ( states.counter.motion_detected_counter.state|int / states.counter.motion_counter.state|int ) * 100.0 }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    # derived attributes from statistics on percent
    motion_detected_percent_mean:
      entity_id:
        - sensor.motion_detected_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_detected_percent_statistics is defined %}
          {{ states.sensor.motion_detected_percent_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_min_value:
      entity_id:
        - sensor.motion_detected_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_detected_percent_statistics is defined %}
          {{ states.sensor.motion_detected_percent_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_max_value:
      entity_id:
        - sensor.motion_detected_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_detected_percent_statistics is defined %}
          {{ states.sensor.motion_detected_percent_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_stdev:
      entity_id:
        - sensor.motion_detected_percent_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states.sensor.motion_detected_percent_statistics is defined %}
          {{ states.sensor.motion_detected_percent_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_percent_change_rate:
      entity_id:
        - sensor.motion_detected_percent_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states.sensor.motion_detected_percent_statistics is defined %}
          {{ states.sensor.motion_detected_percent_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## counting entities detected
    motion_detected_count:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_detected
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.count }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    ## derived attributes from statistics on entity count
    motion_detected_count_mean:
      entity_id:
        - sensor.motion_detected_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_count_statistics is defined %}
          {{ states.sensor.motion_detected_count_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_min_value:
      entity_id:
        - sensor.motion_detected_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_count_statistics is defined %}
          {{ states.sensor.motion_detected_count_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_max_value:
      entity_id:
        - sensor.motion_detected_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_count_statistics is defined %}
          {{ states.sensor.motion_detected_count_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_stdev:
      entity_id:
        - sensor.motion_detected_count_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states.sensor.motion_detected_count_statistics is defined %}
          {{ states.sensor.motion_detected_count_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_count_change_rate:
      entity_id:
        - sensor.motion_detected_count_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states.sensor.motion_detected_count_statistics is defined %}
          {{ states.sensor.motion_detected_count_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## attributes (only update iff something detected)
    motion_detected_device:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_detected
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.event.device }}
          {% else %}{{ states.sensor.motion_detected_device.state }}{% endif %}
        {% else %}null{% endif %}
    motion_detected_camera:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_detected
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.event.camera }}
          {% else %}{{ states.sensor.motion_detected_camera.state }}{% endif %}
        {% else %}null{% endif %}
    motion_detected_picture:
      entity_id:
        - sensor.motion_event_annotated
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.sensor.motion_event_annotated.attributes.count|int > 0 %}
            {{- state_attr('camera.motion_annotated_' + states.sensor.motion_event_annotated.attributes.event.camera, 'entity_picture') -}}
          {% else %}null{% endif %}
        {% else %}null{% endif %}

###
### ENTITY DETECTED
###

- platform: template
  sensors:
    ## human readable status
    motion_detected_entity_status:
      entity_id:
        - binary_sensor.motion_detected_entity
        - sensor.motion_event_annotated
      value_template: >-
        {% if states.sensor.motion_detect_entity_count is defined %}
          {% if states.sensor.motion_detect_entity_count.state|int > 0 %}
            Detected {{ states.sensor.motion_detect_entity_count.state }} {{ states.sensor.motion_entity_detect.state -}}(s)
          {% else %}
            No {{ states.sensor.motion_entity_detect.state -}} detected
          {% endif %}
          from {{ states.sensor.motion_event_annotated.attributes.event.device -}}/{{- states.sensor.motion_event_annotated.attributes.event.camera }} 
        {% else %}null{% endif %}

    ## timing
    motion_detected_entity_date:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_detected_entity
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected_entity.state == 'on' %}
            {% if states.sensor.motion_event_annotated.attributes.event.end|int is number %}
              {% if states.sensor.motion_event_annotated.attributes.event.end|int > 0 %}
                {{ states.sensor.motion_event_annotated.attributes.event.end|int }}
              {% else %}null{% endif %}
            {% else %}null{% endif %}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    # human readable
    motion_detected_entity_when:
      entity_id:
        - sensor.motion_detected_entity_date
      value_template: >-
        {% if states.sensor.motion_detected_entity_date is defined %}
          {{ states.sensor.motion_detected_entity_date.state|int|timestamp_custom("%a %b %d ~ %I:%M %p") }}
        {% else %}null{% endif %}
    # ago
    motion_detected_entity_ago:
      entity_id:
        - sensor.motion_detected_entity_date
        - sun.sun
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_date is defined %}
          {% if states.sensor.motion_detected_entity_date.state|int is number %}
            {% if states.sensor.motion_detected_entity_date.state|int > 0 %}
              {{ (now().timestamp()|int) - (states.sensor.motion_detected_entity_date.state|int) }}
            {%- else -%}null{%- endif -%}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    # derived ago
    motion_detected_entity_ago_mean:
      entity_id:
        - sensor.motion_detected_entity_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_ago_statistics is defined %}
          {% if states.sensor.motion_detected_entity_ago_statistics.state|int is number %}
            {{ states.sensor.motion_detected_entity_ago_statistics.state|float }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_min_value:
      entity_id:
        - sensor.motion_detected_entity_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_ago_statistics is defined %}
          {{ states.sensor.motion_detected_entity_ago_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_max_value:
      entity_id:
        - sensor.motion_detected_entity_ago_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_ago_statistics is defined %}
          {{ states.sensor.motion_detected_entity_ago_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_stdev:
      entity_id:
        - sensor.motion_detected_entity_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_ago_statistics is defined %}
          {{ states.sensor.motion_detected_entity_ago_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_ago_change_rate:
      entity_id:
        - sensor.motion_detected_entity_ago_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_ago_statistics is defined %}
          {{ states.sensor.motion_detected_entity_ago_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # elapsed
    motion_detected_entity_elapsed:
      entity_id:
        - sensor.motion_event_annotated
        - binary_sensor.motion_detected
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected_entity.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.event.elapsed|int }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    motion_detected_entity_elapsed_mean:
      entity_id:
        - sensor.motion_detected_entity_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_entity_elapsed_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_elapsed_min_value:
      entity_id:
        - sensor.motion_detected_entity_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_entity_elapsed_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_elapsed_max_value:
      entity_id:
        - sensor.motion_detected_entity_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >-
        {% if states.sensor.motion_detected_entity_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_entity_elapsed_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_elapsed_stdev:
      entity_id:
        - sensor.motion_detected_entity_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_entity_elapsed_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_elapsed_change_rate:
      entity_id:
        - sensor.motion_detected_entity_elapsed_statistics
      unit_of_measurement: seconds
      value_template: >
        {% if states.sensor.motion_detected_entity_elapsed_statistics is defined %}
          {{ states.sensor.motion_detected_entity_elapsed_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## counting annotated events with detected entity
    motion_detected_entity_counter:
      entity_id:
        - counter.motion_detected_entity_counter
      unit_of_measurement: count
      value_template: >
        {% if states.counter.motion_detected_entity_counter is defined %}
          {{ states.counter.motion_detected_entity_counter.state|int }}
        {%- else -%}null{%- endif -%}
    ## detected entity counter
    motion_detected_entity_counter_mean:
      entity_id:
        - sensor.motion_detected_entity_counter_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_detected_entity_counter_statistics is defined %}
          {{ states.sensor.motion_detected_entity_counter_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_min_value:
      entity_id:
        - sensor.motion_detected_entity_counter_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_detected_entity_counter_statistics is defined %}
          {{ states.sensor.motion_detected_entity_counter_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_max_value:
      entity_id:
        - sensor.motion_detected_entity_counter_statistics
      unit_of_measurement: count
      value_template: >-
        {% if states.sensor.motion_detected_entity_counter_statistics is defined %}
          {{ states.sensor.motion_detected_entity_counter_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_stdev:
      entity_id:
        - sensor.motion_detected_entity_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_detected_entity_counter_statistics is defined %}
          {{ states.sensor.motion_detected_entity_counter_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_counter_change_rate:
      entity_id:
        - sensor.motion_detected_entity_counter_statistics
      unit_of_measurement: count
      value_template: >
        {% if states.sensor.motion_detected_entity_counter_statistics is defined %}
          {{ states.sensor.motion_detected_entity_counter_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    # percent of motion events which were detected
    motion_detected_entity_percent:
      entity_id:
        - counter.motion_counter
        - counter.motion_detected_entity_counter
      unit_of_measurement: '%'
      value_template: >-
        {% if states.counter.motion_counter is defined and states.motion_detected_counter is defined %}
          {% if states.counter.motion_counter.state|int > 0 %}
            {{ ( states.counter.motion_detected_entity_counter.state|int / states.counter.motion_counter.state|int ) * 100.0 }}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    ## detected entity percent
    motion_detected_entity_percent_mean:
      entity_id:
        - sensor.motion_detected_entity_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_detected_entity_percent_statistics is defined %}
          {{ states.sensor.motion_detected_entity_percent_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_min_value:
      entity_id:
        - sensor.motion_detected_entity_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_detected_entity_percent_statistics is defined %}
          {{ states.sensor.motion_detected_entity_percent_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_max_value:
      entity_id:
        - sensor.motion_detected_entity_percent_statistics
      unit_of_measurement: '%'
      value_template: >-
        {% if states.sensor.motion_detected_entity_percent_statistics is defined %}
          {{ states.sensor.motion_detected_entity_percent_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_stdev:
      entity_id:
        - sensor.motion_detected_entity_percent_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states.sensor.motion_detected_entity_percent_statistics is defined %}
          {{ states.sensor.motion_detected_entity_percent_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_percent_change_rate:
      entity_id:
        - sensor.motion_detected_entity_percent_statistics
      unit_of_measurement: '%'
      value_template: >
        {% if states.sensor.motion_detected_entity_percent_statistics is defined %}
          {{ states.sensor.motion_detected_entity_percent_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## counting entities detected
    motion_detected_entity_loop:
      entity_id:
        - sensor.motion_event_annotated
        - sensor.motion_detect_entity
        # - sun.sun
      # loop through all entities & count
      value_template: >-
        {% if states.sensor.motion_event_annotated.attributes.count|int > 0 %}
          {% for detected in states.sensor.motion_event_annotated.attributes.detected %}
            {% if detected.entity == states.sensor.motion_detect_entity.state and detected.count|int > 0 %}{{ detected.count }}{% endif %}
          {% endfor %}
        {% else %}0{% endif %}
    motion_detected_entity_count:
      entity_id:
        - sensor.motion_detected_entity_loop
      # TBD: set through automation to '{{ states.sensor.motion_entity_detect.state }}' 
      unit_of_measurement: entities
      # use loop count or zero
      value_template: >-
        {% if states.sensor.motion_detected_entity_loop is defined %}
          {{ states.sensor.motion_detected_entity_loop.state|int }}
        {% else %}0{% endif %}
    ## derived motion detected entity count statistics
    motion_detected_entity_count_mean:
      entity_id:
        - sensor.motion_detected_entity_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_entity_count_statistics is defined %}
          {{ states.sensor.motion_detected_entity_count_statistics.state|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_min_value:
      entity_id:
        - sensor.motion_detected_entity_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_entity_count_statistics is defined %}
          {{ states.sensor.motion_detected_entity_count_statistics.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_max_value:
      entity_id:
        - sensor.motion_detected_entity_count_statistics
      unit_of_measurement: entities
      value_template: >-
        {% if states.sensor.motion_detected_entity_count_statistics is defined %}
          {{ states.sensor.motion_detected_entity_count_statistics.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_stdev:
      entity_id:
        - sensor.motion_detected_entity_count_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states.sensor.motion_detected_entity_count_statistics is defined %}
          {{ states.sensor.motion_detected_entity_count_statistics.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_detected_entity_count_change_rate:
      entity_id:
        - sensor.motion_detected_entity_count_statistics
      unit_of_measurement: entities
      value_template: >
        {% if states.sensor.motion_detected_entity_count_statistics is defined %}
          {{ states.sensor.motion_detected_entity_count_statistics.attributes.change_rate|float }}
        {%- else -%}null{%- endif -%}

    ## conditionally updated attributes of annotated event detecting entity
    motion_detected_entity_device:
      entity_id:
        - binary_sensor.motion_detected_entity
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected_entity.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.event.device }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    motion_detected_entity_camera:
      entity_id:
        - binary_sensor.motion_detected_entity
        - sensor.motion_detect_entity
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.binary_sensor.motion_detected_entity.state == 'on' %}
            {{ states.sensor.motion_event_annotated.attributes.event.camera }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}
    motion_detected_entity_picture:
      entity_id:
        - sensor.motion_event_annotated
        - sensor.motion_detected_entity_count
      value_template: >-
        {% if states.sensor.motion_event_annotated is defined %}
          {% if states.sensor.motion_detected_entity_count.state|int > 0  %}
            {{ state_attr('camera.motion_annotated_' + states.sensor.motion_event_annotated.attributes.event.camera, 'entity_picture') }}
          {% else %}null{% endif %}
        {% else %}null{% endif %}

###

- platform: history_stats
  name: motion_counter_history
  entity_id: sensor.motion_event_end
  state: 'True'
  type: count
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

- platform: history_stats
  name: motion_image_history
  entity_id: binary_sensor.motion_image_state
  state: 'on'
  type: count
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

- platform: history_stats
  name: motion_annotated_history
  entity_id: binary_sensor.motion_annotated
  state: 'on'
  type: count
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

- platform: history_stats
  name: motion_detected_history
  entity_id: binary_sensor.motion_detected
  state: 'on'
  type: count
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

- platform: history_stats
  name: motion_detected_entity_history
  entity_id: binary_sensor.motion_detected_entity
  state: 'on'
  type: count
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

###
### statistics
###

## motion

# counting event_image
- platform: statistics
  name: motion_image_counter_statistics
  entity_id: sensor.motion_image_counter
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_image_counter_stdev_statistics
  entity_id: sensor.motion_image_counter_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds ago
- platform: statistics
  name: motion_image_ago_statistics
  entity_id: sensor.motion_image_ago
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_image_ago_stdev_statistics
  entity_id: sensor.motion_image_ago_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds ago
- platform: statistics
  name: motion_ago_statistics
  entity_id: sensor.motion_ago
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_ago_stdev_statistics
  entity_id: sensor.motion_ago_stdev
  sampling_size: 100
  max_age:
    hours: 24

# counting events
- platform: statistics
  name: motion_counter_statistics
  entity_id: sensor.motion_counter
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_counter_stdev_statistics
  entity_id: sensor.motion_counter_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds ago
- platform: statistics
  name: motion_ago_statistics
  entity_id: sensor.motion_ago
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_ago_stdev_statistics
  entity_id: sensor.motion_ago_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds elapsed
- platform: statistics
  name: motion_elapsed_statistics
  entity_id: sensor.motion_elapsed
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_elapsed_stdev_statistics
  entity_id: sensor.motion_elapsed_stdev
  sampling_size: 100
  max_age:
    hours: 24

## annotated

# counter
- platform: statistics
  name: motion_annotated_counter_statistics
  entity_id: sensor.motion_annotated_counter
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_counter_stdev_statistics
  entity_id: sensor.motion_annotated_counter_stdev
  sampling_size: 100
  max_age:
    hours: 24

# entity count
- platform: statistics
  name: motion_annotated_count_statistics
  entity_id: sensor.motion_annotated_count
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_count_stdev_statistics
  entity_id: sensor.motion_annotated_count_stdev
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_count_statistics
  entity_id: sensor.motion_annotated_count
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_count_stdev_statistics
  entity_id: sensor.motion_annotated_count_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds ago
- platform: statistics
  name: motion_annotated_ago_statistics
  entity_id: sensor.motion_annotated_ago
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_ago_stdev_statistics
  entity_id: sensor.motion_annotated_ago_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds elapsed
- platform: statistics
  name: motion_annotated_elapsed_statistics
  entity_id: sensor.motion_annotated_elapsed
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_elapsed_stdev_statistics
  entity_id: sensor.motion_annotated_elapsed_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds delay
- platform: statistics
  name: motion_annotated_delay_statistics
  entity_id: sensor.motion_annotated_delay
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_delay_stdev_statistics
  entity_id: sensor.motion_annotated_delay_stdev
  sampling_size: 100
  max_age:
    hours: 24

# annotated percent
- platform: statistics
  name: motion_annotated_percent_statistics
  entity_id: sensor.motion_annotated_percent
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_annotated_percent_stdev_statistics
  entity_id: sensor.motion_annotated_percent_stdev
  sampling_size: 100
  max_age:
    hours: 24

## detected

# counter
- platform: statistics
  name: motion_detected_counter_statistics
  entity_id: sensor.motion_detected_counter
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_counter_stdev_statistics
  entity_id: sensor.motion_detected_counter_stdev
  sampling_size: 100
  max_age:
    hours: 24

# entity count
- platform: statistics
  name: motion_detected_count_statistics
  entity_id: sensor.motion_detected_count
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_count_stdev_statistics
  entity_id: sensor.motion_detected_count_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds ago
- platform: statistics
  name: motion_detected_ago_statistics
  entity_id: sensor.motion_detected_ago
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_ago_stdev_statistics
  entity_id: sensor.motion_detected_ago_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds elapsed
- platform: statistics
  name: motion_detected_elapsed_statistics
  entity_id: sensor.motion_detected_elapsed
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_elapsed_stdev_statistics
  entity_id: sensor.motion_detected_elapsed_stdev
  sampling_size: 100
  max_age:
    hours: 24

# detected percent
- platform: statistics
  name: motion_detected_percent_statistics
  entity_id: sensor.motion_detected_percent
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_percent_stdev_statistics
  entity_id: sensor.motion_detected_percent_stdev
  sampling_size: 100
  max_age:
    hours: 24

## detected entity

# counter
- platform: statistics
  name: motion_detected_entity_counter_statistics
  entity_id: sensor.motion_detected_entity_counter
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_entity_counter_stdev_statistics
  entity_id: sensor.motion_detected_entity_counter_stdev
  sampling_size: 100
  max_age:
    hours: 24

# entity count
- platform: statistics
  name: motion_detected_entity_count_statistics
  entity_id: sensor.motion_detected_entity_count
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_entity_count_stdev_statistics
  entity_id: sensor.motion_detected_entity_count_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds ago
- platform: statistics
  name: motion_detected_entity_ago_statistics
  entity_id: sensor.motion_detected_entity_ago
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_entity_ago_stdev_statistics
  entity_id: sensor.motion_detected_entity_ago_stdev
  sampling_size: 100
  max_age:
    hours: 24

# seconds elapsed
- platform: statistics
  name: motion_detected_entity_elapsed_statistics
  entity_id: sensor.motion_detected_entity_elapsed
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_entity_elapsed_stdev_statistics
  entity_id: sensor.motion_detected_entity_elapsed_stdev
  sampling_size: 100
  max_age:
    hours: 24

# detected entity percent
- platform: statistics
  name: motion_detected_entity_percent_statistics
  entity_id: sensor.motion_detected_entity_percent
  sampling_size: 100
  max_age:
    hours: 24
- platform: statistics
  name: motion_detected_entity_percent_stdev_statistics
  entity_id: sensor.motion_detected_entity_percent_stdev
  sampling_size: 100
  max_age:
    hours: 24

